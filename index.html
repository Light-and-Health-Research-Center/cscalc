<!DOCTYPE html>
<html lang="en" class="h-100">
  <head>
    <title>CS Calculator (2.0) | Light and Health Research Center</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="device-width, initial-scale=1" />
    <meta
      name="description"
      content="Calculate the circadian effectiveness of a light source using the Light and Health Research Center's CS Calculator 2.0"
    />

    <!-- Favicon Stuff -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#01aeef" />
    <meta name="msapplication-TileColor" content="#00aba9" />
    <meta name="theme-color" content="#ffffff" />

    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.css"
    />
    <script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.3/Chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="js/animation.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/generalFunctions.js"></script>
    <script src="js/lightMetricFunctions.js"></script>
    <script src="js/userFunctions.js"></script>
    <link rel="stylesheet" href="css/css.css" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700&display=swap"
    />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  </head>
  <body>
    <div
      class="modal"
      id="custom-source-modal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="custom-source-modal-label"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="custom-source-modal-label">
              Add Custom Source
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form autocomplete="off">
              <div class="form-group">
                <label for="userID">*Source Name</label>
                <input
                  type="text"
                  class="
                    form-control
                    custom-form-control
                    userSortSource
                    userEnter
                  "
                  id="userID"
                  placeholder="Custom Source"
                />
              </div>
              <div class="form-row">
                <div class="col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label for="userMan">Manufacturer</label>
                    <input
                      type="text"
                      class="
                        form-control
                        custom-form-control
                        userSortSource
                        userEnter
                      "
                      id="userMan"
                      placeholder="GE"
                    />
                  </div>
                </div>
                <div class="col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label for="userCCT">CCT/Color</label>
                    <div class="input-group">
                      <input
                        type="text"
                        class="
                          form-control
                          custom-form-control
                          userSortSource
                          userEnter
                        "
                        id="userCCT"
                        placeholder="6500 K"
                      />
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="form-group">
                    <label for="userLamp">Lamp Type</label>
                    <input
                      type="text"
                      class="
                        form-control
                        custom-form-control
                        userSortSource
                        userEnter
                      "
                      id="userLamp"
                      placeholder="Daylight"
                    />
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label for="userDesc">Description</label>
                <textarea
                  class="form-control custom-form-control"
                  id="userDesc"
                  rows="2"
                  placeholder="My Custom Source"
                ></textarea>
              </div>

              <div id="userSPDTogetherContainer">
                <div class="form-group">
                  <div class="position-relative">
                    <div class="btn-menu">
                      <button
                        class="btn btn-link btn-menu-btn"
                        type="button"
                        data-toggle="tooltip"
                        title="Toggle SPD Input Type"
                      >
                        <i
                          class="change-spd-input-type fas fa-lg fa-toggle-off"
                        ></i>
                      </button>
                    </div>
                    <label for="userSPDTogether">*SPD</label>
                  </div>

                  <textarea
                    class="form-control custom-form-control"
                    id="userSPDTogether"
                    rows="5"
                    placeholder="380&#9;0.0020065&#10;382&#9;0.0016818&#10;384&#9;0.001013&#10;386&#9;0.00054935&#10;388&#9;0.00027727"
                  ></textarea>
                  <small class="form-text text-muted">*required</small>
                  <div class="editCustomSourceError"></div>
                </div>
              </div>

              <div id="userSPDSeperateContainer" class="d-none">
                <div class="form-row">
                  <div class="col-sm-6 col-xs-12">
                    <div class="form-group">
                      <label for="userSPDWavelengths">*λ</label>
                      <textarea
                        class="form-control custom-form-control"
                        id="userSPDWavelengths"
                        rows="5"
                        placeholder="380&#10;382&#10;384&#10;386&#10;388"
                      ></textarea>
                      <small class="form-text text-muted">*required</small>
                      <div class="addCustomSourceError"></div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xs-12">
                    <div class="form-group">
                      <div class="position-relative">
                        <div class="btn-menu">
                          <button
                            class="btn btn-link btn-menu-btn"
                            type="button"
                            data-toggle="tooltip"
                            title="Toggle SPD Input Type"
                          >
                            <i
                              class="
                                change-spd-input-type
                                fas
                                fa-lg fa-toggle-off
                              "
                            ></i>
                          </button>
                        </div>
                        <label for="userSPDValues">*Values</label>
                      </div>
                      <textarea
                        class="form-control custom-form-control"
                        id="userSPDValues"
                        rows="5"
                        placeholder="0.0020065&#10;0.0016818&#10;0.001013&#10;0.00054935&#10;0.00027727"
                      ></textarea>
                    </div>
                  </div>
                </div>
              </div>

              <button
                id="userSourceSubmit"
                class="btn btn-ms disabled w-100"
                type="button"
                data-dismiss="modal"
                aria-label="Close"
                onclick="submitUserSource()"
              >
                Add Source
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal"
      id="edit-custom-source-modal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="edit-custom-source-modal-label"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="edit-custom-source-modal-label">
              Edit Custom Source
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form autocomplete="off">
              <div class="form-group">
                <label for="edit-userID">*Source Name</label>
                <input
                  type="text"
                  class="
                    form-control
                    custom-form-control
                    userSortSource
                    userEnter
                  "
                  id="edit-userID"
                  placeholder="Custom Source"
                />
              </div>
              <div class="form-row">
                <div class="col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label for="edit-userMan">Manufacturer</label>
                    <input
                      type="text"
                      class="
                        form-control
                        custom-form-control
                        userSortSource
                        userEnter
                      "
                      id="edit-userMan"
                      placeholder="GE"
                    />
                  </div>
                </div>
                <div class="col-sm-4 col-xs-12">
                  <div class="form-group">
                    <label for="edit-userCCT">CCT/Color</label>
                    <div class="input-group">
                      <input
                        type="text"
                        class="
                          form-control
                          custom-form-control
                          userSortSource
                          userEnter
                        "
                        id="edit-userCCT"
                        placeholder="6500"
                      />
                      <div class="input-group-append">
                        <span
                          class="
                            input-group-text
                            custom-input-group-text
                            d-block
                          "
                          >K</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="form-group">
                    <label for="edit-userLamp">Lamp Type</label>
                    <input
                      type="text"
                      class="
                        form-control
                        custom-form-control
                        userSortSource
                        userEnter
                      "
                      id="edit-userLamp"
                      placeholder="Daylight"
                    />
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label for="edit-userDesc">Description</label>
                <textarea
                  class="form-control custom-form-control"
                  id="edit-userDesc"
                  rows="2"
                  placeholder="My Custom Source"
                ></textarea>
              </div>

              <div id="edit-userSPDTogetherContainer">
                <div class="form-group">
                  <div class="position-relative">
                    <div class="btn-menu">
                      <button
                        class="btn btn-link btn-menu-btn"
                        type="button"
                        data-toggle="tooltip"
                        title="Toggle SPD Input Type"
                      >
                        <i
                          class="
                            edit-change-spd-input-type
                            fas
                            fa-lg fa-toggle-off
                          "
                        ></i>
                      </button>
                    </div>
                    <label for="edit-userSPDTogether">*SPD</label>
                  </div>

                  <textarea
                    class="form-control custom-form-control"
                    id="edit-userSPDTogether"
                    rows="5"
                    placeholder="380&#9;0.0020065&#10;382&#9;0.0016818&#10;384&#9;0.001013&#10;386&#9;0.00054935&#10;388&#9;0.00027727"
                  ></textarea>
                  <small class="form-text text-muted">*required</small>
                  <div class="edit-addCustomSourceError"></div>
                </div>
              </div>

              <div id="edit-userSPDSeperateContainer" class="d-none">
                <div class="form-row">
                  <div class="col-sm-6 col-xs-12">
                    <div class="form-group">
                      <label for="edit-userSPDWavelengths">*λ</label>
                      <textarea
                        class="form-control custom-form-control"
                        id="edit-userSPDWavelengths"
                        rows="5"
                        placeholder="380&#10;382&#10;384&#10;386&#10;388"
                      ></textarea>
                      <small class="form-text text-muted">*required</small>
                      <div class="addCustomSourceError"></div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-xs-12">
                    <div class="form-group">
                      <div class="position-relative">
                        <div class="btn-menu">
                          <button
                            class="btn btn-link btn-menu-btn"
                            type="button"
                            data-toggle="tooltip"
                            title="Toggle SPD Input Type"
                          >
                            <i
                              class="
                                edit-change-spd-input-type
                                fas
                                fa-lg fa-toggle-off
                              "
                            ></i>
                          </button>
                        </div>
                        <label for="edit-userSPDValues">*Values</label>
                      </div>
                      <textarea
                        class="form-control custom-form-control"
                        id="edit-userSPDValues"
                        rows="5"
                        placeholder="0.0020065&#10;0.0016818&#10;0.001013&#10;0.00054935&#10;0.00027727"
                      ></textarea>
                    </div>
                  </div>
                </div>
              </div>

              <button
                id="edit-userSourceSubmit"
                class="btn btn-ms disabled w-100"
                type="button"
                data-dismiss="modal"
                aria-label="Close"
                onclick="editUserSource(this)"
              >
                Edit Source
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal"
      id="source-modal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="source-modal-label"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="source-modal-label">Source Title</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p class="m-0">
              <b>Lamp Type:</b><span class="pl-1" id="source-lamptype"></span>
            </p>
            <p class="m-0">
              <b>CCT/Color:</b><span class="pl-1" id="source-cct"></span>
            </p>
            <p class="m-0">
              <b>Manufacturer:</b
              ><span class="pl-1" id="source-manufacturer"></span>
            </p>
            <p
              id="sourceModalDescriptionCollapse"
              class="m-0 pointer text-truncate"
              data-toggle="tooltip"
              title="Expand Description"
            >
              <b>Description:</b><span class="pl-1" id="source-info"></span>
            </p>
            <p><b>SPD:</b></p>
            <canvas class="source-spd" id="source-spd"></canvas>
          </div>
          <div id="source-modal-footer" class="modal-footer">
            <button
              id="source-add"
              class="btn btn-ms addSource py-1"
              type="button"
              data-dismiss="modal"
            >
              Add Source
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal"
      id="upload-sources-modal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="upload-sources-modal-label"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="upload-sources-modal-label">
              Upload Custom Sources from JSON
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body text-center">
            <input
              autocomplete="off"
              type="file"
              accept=".json"
              id="upload-custom-sources-input"
              class="text-truncate w-100 mb-4"
              multiple
            />
            <div id="upload-custom-sources-errors"></div>
            <button class="btn btn-ms m-2 py-1" onClick="uploadCustomSources()">
              Upload Sources
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="content" class="container-fluid px-0 mt-4">
      <div class="opacity-0" id="logo-container">
        <div class="row mb-4 mx-0 d-flex">
          <div class="col text-center">
            <h1 class="mb-0">
              <a href="https://icahn.mssm.edu/research/light-health"
                ><img
                  id="LHRC_Logo"
                  src="img/LHRC_Logo.png"
                  width="200"
                  class="pr-3" /></a
              >CS Calculator (2.0)
            </h1>
          </div>
        </div>
      </div>
      <div id="main-card-row" class="row opacity-0 mx-0">
        <div class="col px-0">
          <div class="card mb-0 sm-mb-3 drop-shadow">
            <div
              class="
                main-card-header
                card-header
                border-bottom-0
                p-0
                position-relative
              "
            >
              <div class="container-fluid">
                <div class="row">
                  <div class="col-md-6 p-0">
                    <div id="stepChange1" class="step-title-container active rounded-tl">
                      <div class="btn-menu-left">
                        <a href="https://docs.light-health.org/cscalc" target="_blank" >
                          <button
                            class="btn btn-link btn-menu-btn"
                            type="button"
                            data-toggle="tooltip"
                            title="View CS Calculator Documentation"
                          >
                            <i class="far fa-lg fa-question-circle"></i>
                          </button>
                          </a>
                      </div>
                      <h2
                        class="
                          step-title
                          font-size-1_5
                          py-2
                          text-center
                          mb-0
                          active
                        "
                      >
                        Sources
                      </h2>
                    </div>
                  </div>
                  <div class="col-md-6 p-0">
                    <div id="stepChange2" class="step-title-container disabled rounded-tr">
                      <div class="btn-menu">
                        <button
                          id="resultsDownload"
                          class="btn btn-link btn-menu-btn"
                          type="button"
                          data-toggle="tooltip"
                          title="Download All Calculations as JSON"
                        >
                          <i class="fas fa-lg fa-download"></i>
                        </button>
                      </div>
                      <h2
                        class="step-title font-size-1_5 py-2 text-center mb-0"
                      >
                        Calculations
                      </h2>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="stepContent1" class="card-body">
              <div class="container-fluid">
                <div class="row">
                  <div class="col-xl-6">
                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#filters"
                              aria-expanded="false"
                              aria-controls="filters"
                            >
                              Source List Filters
                            </h2>
                          </div>
                          <div class="collapse" id="filters">
                            <div class="card-body">
                              <div class="input-group mb-3">
                                <div
                                  class="input-group-prepend mw-175 text-center"
                                >
                                  <label
                                    class="
                                      input-group-text
                                      d-block
                                      mw-175
                                      text-center
                                    "
                                    for="manufacterer"
                                    ><b>Manufacturer:</b></label
                                  >
                                </div>
                                <select
                                  class="custom-select sortSource"
                                  id="manufacterer"
                                >
                                  <option selected>Any</option>
                                </select>
                              </div>
                              <div class="input-group mb-3">
                                <div class="input-group-prepend mw-175">
                                  <label
                                    class="input-group-text d-block mw-175"
                                    for="cct"
                                    ><b>CCT/Color:</b></label
                                  >
                                </div>
                                <select
                                  class="custom-select sortSource"
                                  id="cct"
                                >
                                  <option selected>Any</option>
                                </select>
                              </div>
                              <div class="input-group mb-3">
                                <div class="input-group-prepend mw-175">
                                  <label
                                    class="input-group-text d-block mw-175"
                                    for="lamp"
                                    ><b>Lamp:</b></label
                                  >
                                </div>
                                <select
                                  class="custom-select sortSource"
                                  id="lamp"
                                >
                                  <option selected>Any</option>
                                </select>
                              </div>
                              <div class="input-group mb-3">
                                <div class="input-group-prepend mw-175">
                                  <span
                                    class="input-group-text d-block mw-175"
                                    id="keyword"
                                    ><b>Keyword:</b></span
                                  >
                                </div>
                                <input
                                  id="searchSource"
                                  type="text"
                                  class="form-control sortSource"
                                  aria-label="Default"
                                  aria-describedby="keyword"
                                  placeholder="Search"
                                />
                              </div>
                              <div class="input-group">
                                <button
                                  class="w-100 btn btn-ms text-center"
                                  id="reset"
                                  type="button"
                                >
                                  Reset Filters
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <div class="btn-menu">
                              <span
                                data-toggle="modal"
                                data-target="#upload-sources-modal"
                              >
                                <button
                                  class="btn btn-link btn-menu-btn"
                                  type="button"
                                  data-toggle="tooltip"
                                  title="Upload Custom Sources from JSON"
                                >
                                  <i class="fas fa-upload"></i>
                                </button>
                              </span>
                              <button
                                onClick="downloadCustomSources()"
                                class="btn btn-link btn-menu-btn"
                                type="button"
                                data-toggle="tooltip"
                                title="Download Custom Sources as JSON"
                              >
                                <i class="fas fa-download"></i>
                              </button>
                              <span
                                data-toggle="modal"
                                data-target="#custom-source-modal"
                              >
                                <button
                                  class="btn btn-link btn-menu-btn"
                                  type="button"
                                  data-toggle="tooltip"
                                  title="Add Custom Source"
                                >
                                  <i class="fas fa-plus"></i>
                                </button>
                              </span>
                            </div>
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#source-list"
                              aria-expanded="true"
                              aria-controls="source-list"
                            >
                              Source List
                            </h2>
                          </div>
                          <div class="collapse show" id="source-list">
                            <div class="card-body p-0">
                              <ul
                                id="names-list"
                                class="
                                  list-group list-group-flush list-group-hover
                                  names-list
                                "
                              ></ul>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-xl-6">
                    <div class="row mb-4 sm-mb-5">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#sources_"
                              aria-expanded="true"
                              aria-controls="sources_"
                            >
                              Selected Sources
                            </h2>
                          </div>
                          <div class="collapse show" id="sources_">
                            <div class="card-body" id="sources_-container">
                              <div
                                id="selected-sources_"
                                class="container-fluid"
                              >
                                <div class="no-sources row mb-1">
                                  <div
                                    class="col d-flex justify-content-center"
                                  >
                                    <div>No Selected Sources</div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <button
                      id="continue-to-calculations-button"
                      class="btn btn-ms text-center d-none w-100"
                      type="button"
                    >
                      Continue to Calculations
                      <i class="fas fa-sign-in-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div id="stepContent2" class="card-body d-none">
              <div class="container-fluid">
                <div class="row">
                  <div class="col-xl-6">
                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#sources"
                              aria-expanded="true"
                              aria-controls="sources"
                            >
                              Selected Sources
                            </h2>
                          </div>
                          <div class="collapse show" id="sources">
                            <div class="card-body" id="sources-container">
                              <div id="selected-sources" class="container-fluid mb-4 d-none">
                                <div class="row">
                                  <div class="col">
                                    <p class="small border-bottom font-weight-bold">Calculate via Illuminance (lx)</p>
                                  </div>
                                </div>
                              </div>
                              <div class="container-fluid">
                                <div class="no-sources row mb-1">
                                  <div class="col d-flex justify-content-center">
                                    <div>No Selected Sources</div>
                                  </div>
                                </div>
                              </div>
                              <div id="csInputSection" class="container-fluid d-none mb-4">
                                <div class="row">
                                  <div class="col">
                                    <p class="small border-bottom font-weight-bold">Calculate via CS</p>
                                  </div>
                                </div>
                                <div class="row bg-f2 py-2 rounded">
                                  <div class="col">
                                    <input
                                    oninput="handleLuxChangeFocus()" onfocusout="handleLuxChangeFocusOut()"
                                    onkeydown="if(event.keyCode==13){ $(this).blur(); return false;}"
                                    autocomplete="off" id="csInput" class="form-control" placeholder="0.000">
                                  </div>
                                </div>
                              </div>
                              <div id="lux-change-pending-container" class="container-fluid d-none">
                                <div class="row">
                                  <div class="col text-center">
                                    <div class="font-size-_75 font-italic">
                                      <i class="ms-pink far fa-dot-circle"></i>
                                      changes pending - press enter to
                                      recalculate
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#inputs"
                              aria-expanded="false"
                              aria-controls="inputs"
                            >
                              Input Variables
                            </h2>
                          </div>
                          <div class="collapse" id="inputs">
                            <div class="card-body inputs-container">
                              <div class="container-fluid">
                                <div class="row mb-2 input-variable-row">
                                  <div class="col py-2 input-value-pair">
                                    <div class="input-variable">
                                      Duration of Exposure (hrs):
                                    </div>
                                    <div class="input-group">
                                      <select
                                        class="custom-select"
                                        id="time_sel"
                                      >
                                        <option value="0.5">0.5</option>
                                        <option value="0.75">0.75</option>
                                        <option
                                          value="1.00"
                                          selected="selected"
                                        >
                                          1 (default)
                                        </option>
                                        <option value="1.25">1.25</option>
                                        <option value="1.50">1.5</option>
                                        <option value="1.75">1.75</option>
                                        <option value="2.00">2</option>
                                        <option value="2.25">2.25</option>
                                        <option value="2.50">2.5</option>
                                        <option value="2.75">2.75</option>
                                        <option value="3.00">3</option>
                                      </select>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mb-2 input-variable-row">
                                  <div class="col py-2 input-value-pair">
                                    <div class="input-variable">
                                      Distribution Scalar:
                                    </div>
                                    <select
                                      class="custom-select"
                                      id="scalar_sel"
                                    >
                                      <option value="0.5">0.5</option>
                                      <option value="0.6">0.6</option>
                                      <option value="0.7">0.7</option>
                                      <option value="0.8">0.8</option>
                                      <option value="0.9">0.9</option>
                                      <option value="1.0" selected="selected">
                                        1 (default)
                                      </option>
                                      <option value="1.1">1.1</option>
                                      <option value="1.2">1.2</option>
                                      <option value="1.3">1.3</option>
                                      <option value="1.4">1.4</option>
                                      <option value="1.5">1.5</option>
                                      <option value="1.6">1.6</option>
                                      <option value="1.7">1.7</option>
                                      <option value="1.8">1.8</option>
                                      <option value="1.9">1.9</option>
                                      <option value="2.0">2</option>
                                    </select>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <div class="btn-menu">
                              <button
                                id="download-metrics"
                                class="btn btn-link btn-menu-btn"
                                type="button"
                                data-toggle="tooltip"
                                data-html="true"
                                title="Download Metrics as Text"
                              >
                                <i class="fas fa-download"></i>
                              </button>
                            </div>

                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#measurements"
                              aria-expanded="true"
                              aria-controls="measurements"
                            >
                              Metrics
                            </h2>
                          </div>
                          <div class="collapse show" id="measurements">
                            <div class="card-body measurements-container">
                              
                              <div class="container-fluid">
                                <div class="row">
                                  <div class="col text-center">
                                    <div class="alert alert-warning alert-dismissible fade show" role="alert">
                                      Click <a class="alert-link" href="https://docs.light-health.org/cscalc/announcements/new-cs-model" target="_blank">here</a> to see notes on updated CS Model.
                                      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                      </button>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">CS:</div>
                                    <div id="resultCS" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      CL<sub>A</sub> 2.0:
                                    </div>
                                    <div id="resultCLA" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      Illuminance (lx):
                                    </div>
                                    <div id="resultIll" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      Irradiance (W&middot;m<sup>-2</sup>):
                                    </div>
                                    <div id="resultIrr" class="value">
                                      0.0000e+0
                                    </div>
                                  </div>
                                </div>

                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      Photon Flux
                                      (Photons&middot;m<sup>-2</sup>&middot;s<sup>-1</sup>):
                                    </div>
                                    <div id="resultPf" class="value">
                                      0.0000e+0
                                    </div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      Melanopic EDI:
                                    </div>
                                    <div id="resultMEDI" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">CCT:</div>
                                    <div id="resultCCT" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      D<sub>uv</sub>:
                                    </div>
                                    <div id="resultDuv" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">CRI:</div>
                                    <div id="resultCRI" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">GAI:</div>
                                    <div id="resultGAI" class="value">0</div>
                                  </div>
                                </div>
                                <div class="row mb-1 zebra-row">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                  >
                                    <div class="w-50 text-truncate">
                                      Chromaticity Coordinates (x, y):
                                    </div>
                                    <div id="resultXY" class="value">
                                      0, 0
                                    </div>
                                  </div>
                                </div>
                                <div
                                  class="row mb-1 zebra-row pointer"
                                  id="CIE_alpha_container"
                                  data-toggle="collapse"
                                  href="#CIE_alpha"
                                  aria-expanded="false"
                                  aria-controls="CIE_alpha"
                                >
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-between
                                      zebra-entry
                                    "
                                    data-toggle="tooltip"
                                    title="Toggle CIE  	&alpha;-opic Irradiances"
                                  >
                                    <div>
                                      <i
                                        class="
                                          cie-alpha-caret
                                          ms-purple
                                          fas
                                          fa-caret-right
                                        "
                                      ></i>
                                      CIE &alpha;-opic Irradiances
                                    </div>
                                  </div>
                                </div>
                                <div class="collapse" id="CIE_alpha">
                                  <div class="row mb-1 zebra-row">
                                    <div
                                      class="
                                        col
                                        d-flex
                                        justify-content-between
                                        zebra-entry
                                      "
                                    >
                                      <div class="measurement pl-4">
                                        CIE S-cone Irradiance
                                        (W&middot;m<sup>-2</sup>):
                                      </div>
                                      <div id="resultCIE_S" class="value">
                                        0.0000e+0
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row mb-1 zebra-row">
                                    <div
                                      class="
                                        col
                                        d-flex
                                        justify-content-between
                                        zebra-entry
                                      "
                                    >
                                      <div class="measurement pl-4">
                                        CIE M-cone Irradiance
                                        (W&middot;m<sup>-2</sup>):
                                      </div>
                                      <div id="resultCIE_M" class="value">
                                        0.0000e+0
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row mb-1 zebra-row">
                                    <div
                                      class="
                                        col
                                        d-flex
                                        justify-content-between
                                        zebra-entry
                                      "
                                    >
                                      <div class="measurement pl-4">
                                        CIE L-cone Irradiance
                                        (W&middot;m<sup>-2</sup>):
                                      </div>
                                      <div id="resultCIE_L" class="value">
                                        0.0000e+0
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row mb-1 zebra-row">
                                    <div
                                      class="
                                        col
                                        d-flex
                                        justify-content-between
                                        zebra-entry
                                      "
                                    >
                                      <div class="measurement pl-4">
                                        CIE Rhodopic Irradiance
                                        (W&middot;m<sup>-2</sup>):
                                      </div>
                                      <div id="resultCIE_Rhod" class="value">
                                        0.0000e+0
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row mb-1 zebra-row">
                                    <div
                                      class="
                                        col
                                        d-flex
                                        justify-content-between
                                        zebra-entry
                                      "
                                    >
                                      <div class="measurement pl-4">
                                        CIE Melanopic Irradiance
                                        (W&middot;m<sup>-2</sup>):
                                      </div>
                                      <div id="resultCIE_Mela" class="value">
                                        0.0000e+0
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <div class="btn-menu">
                              <div class="dropleft">
                                <span
                                  id="downloadCombinedSPDDropdown"
                                  data-toggle="dropdown"
                                  aria-haspopup="true"
                                  aria-expanded="false"
                                >
                                  <button
                                    id="download-spds"
                                    class="btn btn-link btn-menu-btn"
                                    type="button"
                                    data-toggle="tooltip"
                                    title="Download Combined SPDs as Text"
                                  >
                                    <i class="fas fa-download"></i>
                                  </button>
                                </span>
                                <div
                                  class="dropdown-menu"
                                  aria-labelledby="downloadCombinedSPDDropdown"
                                >
                                  <a
                                    class="dropdown-item"
                                    id="download-relative-spd"
                                    >Download Relative SPD</a
                                  >
                                  <a
                                    class="dropdown-item"
                                    id="download-absolute-spd"
                                    >Download Absolute SPD</a
                                  >
                                </div>
                              </div>
                            </div>
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#spds"
                              aria-expanded="false"
                              aria-controls="spds"
                            >
                              Combined Source SPDs
                            </h2>
                          </div>
                          <div class="collapse" id="spds">
                            <div class="card-body">
                              <div class="container-fluid">
                                <div class="row mb-4">
                                  <div
                                    class="
                                      col
                                      d-flex
                                      justify-content-around
                                      text-center
                                    "
                                  >
                                    <button
                                      id="RelSpdBtn"
                                      type="button"
                                      class="
                                        flex-fill
                                        spd-button
                                        m-2
                                        py-1
                                        btn btn-ms
                                        active
                                      "
                                    >
                                      Relative
                                    </button>
                                    <button
                                      id="AbsSpdBtn"
                                      type="button"
                                      class="
                                        flex-fill
                                        spd-button
                                        m-2
                                        py-1
                                        btn btn-ms
                                      "
                                    >
                                      Absolute
                                    </button>
                                  </div>
                                </div>
                                <div class="row mb-2">
                                  <div class="col">
                                    <div class="container-fluid">
                                      <div class="row">
                                        <div
                                          class="
                                            col
                                            d-flex
                                            justify-content-around
                                          "
                                        >
                                          <h2>λ (nm)</h2>
                                          <h2>Value</h2>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mb-4 mh-50">
                                  <div class="col">
                                    <div
                                      id="RelSpdContainer"
                                      class="container-fluid spd-container"
                                    ></div>

                                    <div
                                      id="AbsSpdContainer"
                                      class="
                                        container-fluid
                                        spd-container
                                        d-none
                                      "
                                    ></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-xl-6">
                    <div class="row mb-4">
                      <div class="col">
                        <div class="card">
                          <div
                            class="
                              card-header
                              border-bottom-0
                              p-0
                              position-relative
                              pointer
                            "
                          >
                            <h2
                              class="text-center"
                              data-toggle="collapse"
                              data-target="#charts"
                              aria-expanded="true"
                              aria-controls="charts"
                            >
                              Charts
                            </h2>
                          </div>
                          <div class="collapse show" id="charts">
                            <div class="card-body">
                              <div class="container-fluid">
                                <div class="row mb-4">
                                  <div class="col d-flex flex-wrap text-center">
                                    <button
                                      type="button"
                                      id="plotBtnSPD"
                                      class="
                                        flex-fill
                                        plot-btn
                                        btn btn-ms
                                        m-2
                                        py-1
                                        active
                                      "
                                    >
                                      SPD
                                    </button>
                                    <button
                                      type="button"
                                      id="plotBtnChromaticity"
                                      class="
                                        flex-fill
                                        plot-btn
                                        btn btn-ms
                                        m-2
                                        py-1
                                      "
                                    >
                                      Chromaticity
                                    </button>
                                    <button
                                      type="button"
                                      id="plotBtnCRM"
                                      class="
                                        flex-fill
                                        plot-btn
                                        btn btn-ms
                                        m-2
                                        py-1
                                      "
                                    >
                                      Color Rendering
                                    </button>
                                  </div>
                                </div>
                                <div class="row">
                                  <div
                                    id="PlotAreaSPD"
                                    class="plot-area col d-block"
                                  >
                                    <h3 class="text-center">
                                      Spectral Power Distribution
                                    </h3>
                                    <canvas id="spdPlot"></canvas>
                                    <div
                                      id="spdLegend"
                                      class="chart-legend"
                                    ></div>
                                  </div>

                                  <div
                                    id="PlotAreaChromaticity"
                                    class="plot-area col d-none"
                                  >
                                    <h3 class="text-center">Chromaticity</h3>
                                    <canvas id="chromaticityPlot"></canvas>
                                    <div
                                      id="chromaticityLegend"
                                      class="chart-legend"
                                    ></div>
                                  </div>

                                  <div
                                    id="PlotAreaCRM"
                                    class="plot-area col d-none"
                                  >
                                    <h3 class="text-center">
                                      Color Rendering Metrics
                                    </h3>
                                    <canvas id="crmPlot"></canvas>
                                    <div
                                      id="crmLegend"
                                      class="chart-legend"
                                    ></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="
                card-footer
                position-relative
                font-size-1
                text-muted
                page-footer
              "
            >
              <p class="text-center m-0">
                <a href="https://icahn.mssm.edu/research/light-health">
                  <img
                    src="img/MS_Logo.png"
                    width="50"
                    alt="Mount Sinai Logo"
                  />
                </a>
                Copyright ©
                <script>
                  document.write(new Date().getFullYear());
                </script>
                Icahn School of Medicine at Mount Sinai, LHRC. All Rights
                Reserved.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <a id="jsondownload" class="hidden"></a>
    <a id="metrics-download" class="hidden"></a>
    <a id="spd-download" class="hidden"></a>
    <a id="custom-sources-download" class="hidden"></a>
  </body>
</html>
